{% if template.name == 'product' %}
  {% if product.metafields.custom.section_custom_slider_pcr.value.first_slide_title.value == blank and product.metafields.custom.section_custom_slider_pcr.value.first_slide_description.value == blank %}
    <style>
      #shopify-section-{{ section.id }},
      .custom-slider-pcr-mobile-{{ section.id }} {
        display: none;
      }
    </style>
  {% endif %}
{% endif %}

{% style %}
  /* Reset styles scoped to this section */
  #shopify-section-{{ section.id }} .slider-metafield-wrapper * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  /* Main wrapper */
  #shopify-section-{{ section.id }} .slider-metafield-wrapper {
    width: {{ section.settings.wrapper-container-width }}%;
    max-width: 1400px;
    margin: 60px auto;
    padding: 0 20px;
  }

  /* Slider container */
  #shopify-section-{{ section.id }} .slider-metafield-container {
    position: relative;
    width: 100%;
    height: 720px;
    border-radius: 16px;
    overflow: hidden;
    background-color: #1a1a1a;
  }

  /* Background/Slide images */
  #shopify-section-{{ section.id }} .slider-metafield-slides {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
  }

  #shopify-section-{{ section.id }} .slider-metafield-slide {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    opacity: 0;
    transition: opacity 0.6s ease;
  }

  #shopify-section-{{ section.id }} .slider-metafield-slide.active-slide {
    opacity: 1;
  }

  #shopify-section-{{ section.id }} .slider-metafield-slide img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  /* Gradient overlay */
  #shopify-section-{{ section.id }} .slider-metafield-overlay {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 50%;
    background: linear-gradient(to top, rgba(0, 0, 0, 0.85) 0%, rgba(0, 0, 0, 0.4) 50%, transparent 100%);
    pointer-events: none;
  }

  /* Text content - bottom left */
  #shopify-section-{{ section.id }} .slider-metafield-content {
    position: absolute;
    bottom: 60px;
    left: 40px;
    right: 40px;
    z-index: 10;
  }

  #shopify-section-{{ section.id }} .slider-metafield-text {
    max-width: 390px;
  }

  #shopify-section-{{ section.id }} .slider-metafield-text-item {
    display: none;
    width: 390px;
    max-width: 100%;
    height: auto;
    min-height: 98px;
    padding: 24px;
    flex-direction: column;
    justify-content: center;
    align-items: flex-start;
    gap: 8px;
    border-radius: 12px;
    border: 2px solid rgba(10, 132, 255, 0.30);
    background: rgba(0, 0, 0, 0.70);
    backdrop-filter: blur(2px);
    -webkit-backdrop-filter: blur(2px);
  }

  #shopify-section-{{ section.id }} .slider-metafield-text-item.active-text {
    display: flex;
    animation: fadeInText 0.5s ease;
  }

  @keyframes fadeInText {
    from {
      opacity: 0;
      transform: translateY(10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  #shopify-section-{{ section.id }} .slider-metafield-heading {
    font-size: 24px;
    font-weight: 600;
    color: #ffffff;
    margin-bottom: 8px;
    line-height: 1.3;
  }

  #shopify-section-{{ section.id }} .slider-metafield-description {
    font-size: 14px;
    font-weight: 400;
    color: rgba(255, 255, 255, 0.75);
    line-height: 1.5;
  }

  #shopify-section-{{ section.id }} .slider-metafield-description p {
    margin: 0;
    font-size: inherit;
    color: inherit;
    line-height: inherit;
  }

  /* Navigation dots - bottom center */
  #shopify-section-{{ section.id }} .slider-metafield-dots {
    position: absolute;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 10px;
    z-index: 10;
  }

  #shopify-section-{{ section.id }} .slider-metafield-dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    background-color: rgba(255, 255, 255, 0.4);
    cursor: pointer;
    transition: all 0.3s ease;
    border: none;
    padding: 0;
  }

  #shopify-section-{{ section.id }} .slider-metafield-dot:hover {
    background-color: rgba(255, 255, 255, 0.7);
  }

  #shopify-section-{{ section.id }} .slider-metafield-dot.active-dot {
    background-color: #ffffff;
    transform: scale(1.1);
  }

  /* Hide elements */
  #shopify-section-{{ section.id }} .slider-metafield-hide {
    display: none !important;
  }

  /* Responsive - Tablet */
  @media screen and (max-width: 1024px) {
    #shopify-section-{{ section.id }} .slider-metafield-container {
      height: 600px;
    }

    #shopify-section-{{ section.id }} .slider-metafield-content {
      bottom: 50px;
      left: 30px;
      right: 30px;
    }

    #shopify-section-{{ section.id }} .slider-metafield-heading {
      font-size: 22px;
    }
  }

  /* Responsive - Mobile */
  @media screen and (max-width: 768px) {
    #shopify-section-{{ section.id }} .slider-metafield-wrapper {
      margin: 40px auto;
      padding: 0 15px;
    }

    #shopify-section-{{ section.id }} .slider-metafield-container {
      height: 500px;
      border-radius: 12px;
    }

    #shopify-section-{{ section.id }} .slider-metafield-content {
      bottom: 45px;
      left: 20px;
      right: 20px;
    }

    #shopify-section-{{ section.id }} .slider-metafield-text {
      max-width: 100%;
    }

    #shopify-section-{{ section.id }} .slider-metafield-text-item {
      width: 100%;
      padding: 20px;
    }

    #shopify-section-{{ section.id }} .slider-metafield-heading {
      font-size: 18px;
      margin-bottom: 6px;
    }

    #shopify-section-{{ section.id }} .slider-metafield-description {
      font-size: 13px;
    }

    #shopify-section-{{ section.id }} .slider-metafield-dots {
      bottom: 15px;
      gap: 8px;
    }

    #shopify-section-{{ section.id }} .slider-metafield-dot {
      width: 8px;
      height: 8px;
    }
  }

  /* Responsive - Small Mobile */
  @media screen and (max-width: 480px) {
    #shopify-section-{{ section.id }} .slider-metafield-container {
      height: 400px;
    }

    #shopify-section-{{ section.id }} .slider-metafield-content {
      bottom: 40px;
      left: 15px;
      right: 15px;
    }

    #shopify-section-{{ section.id }} .slider-metafield-text-item {
      padding: 16px;
      min-height: auto;
    }

    #shopify-section-{{ section.id }} .slider-metafield-heading {
      font-size: 16px;
    }

    #shopify-section-{{ section.id }} .slider-metafield-description {
      font-size: 12px;
    }
  }
{% endstyle %}


<!-- New Slider Design -->
<div class="slider-metafield-wrapper" id="slider-metafield-{{ section.id }}">
  <div class="slider-metafield-container">
    <!-- Slide Images -->
    <div class="slider-metafield-slides">
      {% if section.settings.slide1_image != blank %}
        <div class="slider-metafield-slide active-slide" data-slide="0">
          <img src="{{ section.settings.slide1_image | img_url: '1400x' }}" alt="{{ section.settings.slide1_title }}">
        </div>
      {% endif %}
      {% if section.settings.slide2_image != blank %}
        <div class="slider-metafield-slide" data-slide="1">
          <img src="{{ section.settings.slide2_image | img_url: '1400x' }}" alt="{{ section.settings.slide2_title }}">
        </div>
      {% endif %}
      {% if section.settings.slide3_image != blank %}
        <div class="slider-metafield-slide" data-slide="2">
          <img src="{{ section.settings.slide3_image | img_url: '1400x' }}" alt="{{ section.settings.slide3_title }}">
        </div>
      {% endif %}
      {% if section.settings.slide4_image != blank %}
        <div class="slider-metafield-slide" data-slide="3">
          <img src="{{ section.settings.slide4_image | img_url: '1400x' }}" alt="{{ section.settings.slide4_title }}">
        </div>
      {% endif %}
    </div>

    <!-- Gradient Overlay -->
    <div class="slider-metafield-overlay"></div>

    <!-- Text Content - Bottom Left -->
    <div class="slider-metafield-content">
      <div class="slider-metafield-text">
        {% if section.settings.slide1_title != blank %}
          <div class="slider-metafield-text-item active-text" data-text="0">
            <h3 class="slider-metafield-heading">{{ section.settings.slide1_title }}</h3>
            <div class="slider-metafield-description">{{ section.settings.slide1_description }}</div>
          </div>
        {% endif %}
        {% if section.settings.slide2_title != blank %}
          <div class="slider-metafield-text-item" data-text="1">
            <h3 class="slider-metafield-heading">{{ section.settings.slide2_title }}</h3>
            <div class="slider-metafield-description">{{ section.settings.slide2_description }}</div>
          </div>
        {% endif %}
        {% if section.settings.slide3_title != blank %}
          <div class="slider-metafield-text-item" data-text="2">
            <h3 class="slider-metafield-heading">{{ section.settings.slide3_title }}</h3>
            <div class="slider-metafield-description">{{ section.settings.slide3_description }}</div>
          </div>
        {% endif %}
        {% if section.settings.slide4_title != blank %}
          <div class="slider-metafield-text-item" data-text="3">
            <h3 class="slider-metafield-heading">{{ section.settings.slide4_title }}</h3>
            <div class="slider-metafield-description">{{ section.settings.slide4_description }}</div>
          </div>
        {% endif %}
      </div>
    </div>

    <!-- Navigation Dots - Bottom Center -->
    <div class="slider-metafield-dots">
      {% if section.settings.slide1_image != blank or section.settings.slide1_title != blank %}
        <button class="slider-metafield-dot active-dot" data-dot="0" aria-label="Go to slide 1"></button>
      {% endif %}
      {% if section.settings.slide2_image != blank or section.settings.slide2_title != blank %}
        <button class="slider-metafield-dot" data-dot="1" aria-label="Go to slide 2"></button>
      {% endif %}
      {% if section.settings.slide3_image != blank or section.settings.slide3_title != blank %}
        <button class="slider-metafield-dot" data-dot="2" aria-label="Go to slide 3"></button>
      {% endif %}
      {% if section.settings.slide4_image != blank or section.settings.slide4_title != blank %}
        <button class="slider-metafield-dot" data-dot="3" aria-label="Go to slide 4"></button>
      {% endif %}
    </div>
  </div>
</div>

<script>
  (function() {
    const wrapper = document.getElementById('slider-metafield-{{ section.id }}');
    if (!wrapper) return;

    const slides = wrapper.querySelectorAll('.slider-metafield-slide');
    const textItems = wrapper.querySelectorAll('.slider-metafield-text-item');
    const dots = wrapper.querySelectorAll('.slider-metafield-dot');

    function changeSlideMetafield(index) {
      // Update slides
      slides.forEach((slide, i) => {
        slide.classList.toggle('active-slide', i === index);
      });

      // Update text
      textItems.forEach((text, i) => {
        text.classList.toggle('active-text', i === index);
      });

      // Update dots
      dots.forEach((dot, i) => {
        dot.classList.toggle('active-dot', i === index);
      });
    }

    // Add click listeners to dots
    dots.forEach((dot, index) => {
      dot.addEventListener('click', () => changeSlideMetafield(index));
    });
  })();
</script>

{% schema %}
{
  "name": "Custom Slider Metafield",
  "settings": [
    {
  "type": "checkbox",
  "id": "emptySpace",
  "label": "Add Empty Space",
  "default": false
    },
    {
      "type": "image_picker",
      "id": "bg_img",
      "label": "Background Image"
    },
    {
      "type": "text",
      "id": "slide1_title",
      "label": "Slide 1 Title"
    },
     {
      "type":"range",
      "id":"wrapper-container-width",
      "min":70,
      "max":100,
      "step":1,
      "label":"Container Width",
      "default":100
    },
    {
      "type": "image_picker",
      "id": "slide1_image",
      "label": "Slide 1 Image"
    },
    {
      "type": "richtext",
      "id": "slide1_description",
      "label": "Slide 1 Description"
    },
    {
      "type": "image_picker",
      "id": "slide1_icon",
      "label": "Slide 1 Icon(SVG)"
    },
    {
      "type": "image_picker",
      "id": "slide1_mobile",
      "label": "Slide 1 Mobile Icon(SVG)"
    },
    {
      "type": "text",
      "id": "slide2_title",
      "label": "Slide 2 Title"
    },
    {
      "type": "image_picker",
      "id": "slide2_image",
      "label": "Slide 2 Image"
    },
    {
      "type": "richtext",
      "id": "slide2_description",
      "label": "Slide 2 Description"
    },
    {
      "type": "image_picker",
      "id": "slide2_icon",
      "label": "Slide 2 Icon"
    },
    {
      "type": "image_picker",
      "id": "slide2_mobile",
      "label": "Slide 2 Mobile Icon"
    },
    {
      "type": "text",
      "id": "slide3_title",
      "label": "Slide 3 Title"
    },
    {
      "type": "image_picker",
      "id": "slide3_image",
      "label": "Slide 3 Image"
    },
    {
      "type": "richtext",
      "id": "slide3_description",
      "label": "Slide 3 Description"
    },
    {
      "type": "image_picker",
      "id": "slide3_icon",
      "label": "Slide 3 Icon(SVG)"
    },
    {
      "type": "image_picker",
      "id": "slide3_mobile",
      "label": "Slide 3 Mobile Icon(SVG)"
    },
      {
      "type": "text",
      "id": "slide4_title",
      "label": "Slide 4 Title"
    },
    {
      "type": "image_picker",
      "id": "slide4_image",
      "label": "Slide 4 Image"
    },
    {
      "type": "richtext",
      "id": "slide4_description",
      "label": "Slide 4 Description"
    },
    {
      "type": "image_picker",
      "id": "slide4_icon",
      "label": "Slide 4 Icon(SVG)"
    },
    {
      "type": "image_picker",
      "id": "slide4_mobile",
      "label": "Slide 4 Mobile Icon(SVG)"
    }

  ],
  "presets":[
    {
      "name":"Custom Slider Metafield"
    }
  ]
}
{% endschema %}

