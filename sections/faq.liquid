<div class="container container--flush container--narrow faq-dev-02-container">
  {% assign faq_title = faq_data.title | default: section.settings.title | default: 'Knowledge Center' %}
  {% assign faq_subtitle = faq_data.subtitle
    | default: section.settings.subtitle
    | default: 'Everything you need to know about Pro Spectrum'
  %}

  <div class="knowledge-center__header">
    <span class="knowledge-center__label" style="color: #FFD700;">
      {{- section.settings.label | default: 'KNOWLEDGE CENTER' -}}
    </span>
    <h2 class="knowledge-center__title">{{ faq_title }}</h2>
    <p class="knowledge-center__subtitle">{{ faq_subtitle }}</p>
  </div>

  <div class="faq" itemscope itemtype="https://schema.org/FAQPage">
    <div class="faq__group-list">
      {%- for block in section.blocks -%}
        {%- if block.type == 'separator' -%}
          {%- unless forloop.first -%}
            </div>
            <!-- Close previous group -->
          {%- endunless -%}

          {%- assign group_id = 'group-' | append: block.id -%}
          <div class="faq__group" data-group-id="{{ group_id }}">
            <div class="faq__group-header" {{ block.shopify_attributes }}>
              <button
                class="faq__group-title-wrapper faq-group-trigger"
                aria-expanded="false"
                data-target="{{ group_id }}"
              >
                <div class="faq__group-title heading h2" id="block-{{ block.id }}">
                  {%- if block.settings.icon_image -%}
                    <span
                      class="faq__group-icon"
                      style="
                        {% if block.settings.icon_width %}width: {{ block.settings.icon_width }}px;{% endif %}
                        {% if block.settings.icon_height %}height: {{ block.settings.icon_height }}px;{% endif %}
                        {% if block.settings.icon_color %}color: {{ block.settings.icon_color }};{% endif %}
                        {% if block.settings.icon_margin_top %}margin-top: {{ block.settings.icon_margin_top }}px;{% endif %}
                        {% if block.settings.icon_margin_right %}margin-right: {{ block.settings.icon_margin_right }}px;{% endif %}
                        {% if block.settings.icon_margin_bottom %}margin-bottom: {{ block.settings.icon_margin_bottom }}px;{% endif %}
                        {% if block.settings.icon_margin_left %}margin-left: {{ block.settings.icon_margin_left }}px;{% endif %}
                      "
                    >
                      <img
                        src="{{ block.settings.icon_image | img_url: '200x' }}"
                        alt="{{ block.settings.title | escape }}"
                        style="width: 100%; height: 100%; object-fit: contain;"
                      >
                    </span>
                  {%- endif -%}

                  <span class="faq__group-title-text">
                    {{- block.settings.title | escape -}}
                  </span>

                  <span class="faq__group-arrow-icon">
                    <svg
                      class="faq-group-arrow-icon"
                      width="24"
                      height="24"
                      viewBox="0 0 24 24"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path d="M6 9L12 15L18 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                  </span>
                </div>
              </button>
            </div>

            <div id="{{ group_id }}" class="faq__group-content">
        {%- endif -%}

        {%- if block.type == 'question' -%}
          <div
            class="faq__item"
            itemscope
            itemprop="mainEntity"
            itemtype="https://schema.org/Question"
            {{ block.shopify_attributes }}
          >
            <div class="faq__item-wrapper">
              <button
                class="faq__question heading h4 faq-question-trigger"
                aria-expanded="false"
                data-target="block-{{ block.id }}"
                itemprop="name"
              >
                <span class="faq__question-text">{{ block.settings.title | escape }}</span>
                <span class="faq__arrow-icon">
                  <svg
                    class="faq-arrow-icon"
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path d="M6 9L12 15L18 9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </span>
              </button>

              <div
                id="block-{{ block.id }}"
                class="faq__answer-wrapper"
                itemscope
                itemprop="acceptedAnswer"
                itemtype="https://schema.org/Answer"
              >
                <div class="faq__answer rte" itemprop="text">
                  {{ block.settings.answer }}
                </div>
              </div>
            </div>
          </div>
        {%- endif -%}

        {%- if forloop.last -%}
          </div>
          <!-- Close group-content -->
          </div>
          <!-- Close group -->
        {%- endif -%}
      {%- endfor -%}
    </div>
  </div>
</div>

<style>
  /*
   * FAQ Section Styles
   * Using high specificity selectors to override theme defaults without !important
   * Only critical overrides use !important where theme uses it too
   */

  /* Base section */
  #shopify-section-{{ section.id }} {
    background: #0a1628;
  }

  /* Container - needs !important to override theme's .container--narrow */
  #shopify-section-{{ section.id }} .container.container--narrow.faq-dev-02-container {
   display: flex;
width: 1280px;
flex-direction: column;
align-items: center;
gap: 60px;
  }

  /* Header Styles */
  #shopify-section-{{ section.id }} .faq-dev-02-container .knowledge-center__header {
    display: flex;
height: 160.5px;
flex-direction: column;
align-items: center;
gap: 24px;
align-self: stretch;
  }

  #shopify-section-{{ section.id }} .faq-dev-02-container .knowledge-center__label {
    height: 20px;
flex-shrink: 0;
align-self: stretch;
color: #D4AF37;
text-align: center;
font-family: Inter;
font-size: 14px;
font-style: normal;
font-weight: 600;
line-height: normal;
letter-spacing: 2px;
  }

  #shopify-section-{{ section.id }} .faq-dev-02-container .knowledge-center__title {
   align-self: stretch;
   color: #FFF;
text-align: center;
font-family: Inter;
font-size: 48px;
font-style: normal;
font-weight: 700;
line-height: 60px; /* 125% */
letter-spacing: -2px;
  }

  #shopify-section-{{ section.id }} .faq-dev-02-container .knowledge-center__subtitle {
  align-self: stretch;
  color: #A0AEC0;
text-align: center;
font-family: Inter;
font-size: 20px;
font-style: normal;
font-weight: 400;
line-height: 39px; /* 195% */
  }

  /* FAQ Container */
  #shopify-section-{{ section.id }} .faq-dev-02-container .faq {
    width: 100%;
    max-width: 100%;
  }

  #shopify-section-{{ section.id }} .faq-dev-02-container .faq__group-list {
    width: 100%;
    display: flex;
    flex-direction: column;
    gap: 0;
  }

  /* FAQ Group */
  #shopify-section-{{ section.id }} .faq-dev-02-container .faq__group {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    margin-bottom: 16px;
    width: 100%;
  }

  #shopify-section-{{ section.id }} .faq-dev-02-container .faq__group-header {
    width: 100%;
    margin-bottom: 0;
  }

  #shopify-section-{{ section.id }} .faq-dev-02-container button.faq__group-title-wrapper {
    width: 100%;
    background: none;
    border: none;
    padding: 0;
    cursor: pointer;
    text-align: left;
    display: block;
    position: relative;
  }

  #shopify-section-{{ section.id }} .faq-dev-02-container .faq__group-title.heading.h2 {
    display: flex;
    align-items: center;
    padding: 24px 20px;
    padding-right: 56px;
    border-radius: 12px;
    border: 1px solid rgba(255, 255, 255, 0.08);
    background: rgba(255, 255, 255, 0.02);
    box-shadow: 0 0 60px 0 rgba(10, 132, 255, 0.12);
    color: #fff;
    font-size: 15px;
    font-weight: 600;
    line-height: 1.4;
    margin: 0;
    width: 100%;
    box-sizing: border-box;
    text-align: left;
    justify-content: flex-start;
    position: relative;
    transition: all 0.3s ease;
  }

  #shopify-section-{{ section.id }} .faq-dev-02-container .faq__group-title.heading.h2:hover {
    border-color: rgba(255, 255, 255, 0.15);
    box-shadow: 0 0 80px 0 rgba(10, 132, 255, 0.18);
  }

  #shopify-section-{{ section.id }} .faq-dev-02-container .faq__group-title-text {
    flex: 1;
    text-align: left;
  }

  #shopify-section-{{ section.id }} .faq-dev-02-container .faq__group-icon {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    margin-right: 14px;
    width: 24px;
    height: 24px;
  }

  #shopify-section-{{ section.id }} .faq-dev-02-container .faq__group-icon img {
    display: block;
    width: 100%;
    height: 100%;
    object-fit: contain;
  }

  /* Group Arrow */
  #shopify-section-{{ section.id }} .faq-dev-02-container .faq__group-arrow-icon {
    position: absolute;
    right: 20px;
    top: 50%;
    transform: translateY(-50%);
    width: 20px;
    height: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  #shopify-section-{{ section.id }} .faq-dev-02-container .faq-group-arrow-icon {
    width: 100%;
    height: 100%;
    color: rgba(255, 255, 255, 0.6);
    transition: transform 0.3s ease;
  }

  #shopify-section-{{ section.id }} .faq-dev-02-container button.faq__group-title-wrapper[aria-expanded='true'] .faq-group-arrow-icon {
    transform: rotate(180deg);
  }

  /* Group Content - Initially hidden */
  #shopify-section-{{ section.id }} .faq-dev-02-container .faq__group-content {
    width: 100%;
    display: none;
  }

  #shopify-section-{{ section.id }} .faq-dev-02-container .faq__group-content.active {
    display: block;
  }

  /* FAQ Item (Question) */
  #shopify-section-{{ section.id }} .faq-dev-02-container .faq__item {
    background: transparent;
    display: block;
    padding: 0;
    border: none;
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    width: 100%;
  }

  #shopify-section-{{ section.id }} .faq-dev-02-container .faq__item:last-child {
    border-bottom: none;
  }

  #shopify-section-{{ section.id }} .faq-dev-02-container .faq__item-wrapper {
    width: 100%;
  }

  #shopify-section-{{ section.id }} .faq-dev-02-container button.faq__question.heading.h4 {
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: 100%;
    padding: 20px 12px;
    margin: 0;
    background: none;
    border: none;
    cursor: pointer;
    text-align: left;
    color: rgba(255, 255, 255, 0.85);
    font-size: 13px;
    font-weight: 500;
    line-height: 1.5;
    transition: color 0.2s ease;
  }

  #shopify-section-{{ section.id }} .faq-dev-02-container button.faq__question.heading.h4:hover {
    color: #fff;
  }

  #shopify-section-{{ section.id }} .faq-dev-02-container .faq__question-text {
    flex: 1;
    min-width: 0;
    padding-right: 16px;
    text-align: left;
  }

  /* Question Arrow */
  #shopify-section-{{ section.id }} .faq-dev-02-container .faq__arrow-icon {
    flex-shrink: 0;
    width: 18px;
    height: 18px;
    min-width: 18px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  #shopify-section-{{ section.id }} .faq-dev-02-container .faq-arrow-icon {
    width: 100%;
    height: 100%;
    color: rgba(255, 255, 255, 0.5);
    transition: transform 0.3s ease;
  }

  #shopify-section-{{ section.id }} .faq-dev-02-container button.faq__question.heading.h4[aria-expanded='true'] .faq-arrow-icon {
    transform: rotate(180deg);
  }

  /* Answer - FIXED VERSION */
  #shopify-section-{{ section.id }} .faq-dev-02-container .faq__answer-wrapper {
    display: none;
    overflow: hidden;
    max-height: 0;
    opacity: 0;
    transition: max-height 0.3s ease, opacity 0.2s ease;
  }

  #shopify-section-{{ section.id }} .faq-dev-02-container .faq__answer-wrapper.active {
    display: inline-table;
    max-height: 1000px; /* Large enough to show all content */
    opacity: 1;
    padding: 0 40px 30px 14px;
  }

  #shopify-section-{{ section.id }} .faq-dev-02-container .faq__answer.rte {
    color: rgba(255, 255, 255, 0.55);
    font-size: 13px;
    line-height: 1.7;
    padding: 0;
    margin: 0;
  }

  #shopify-section-{{ section.id }} .faq-dev-02-container .faq__answer.rte p {
    margin: 0 0 10px 0;
  }

  #shopify-section-{{ section.id }} .faq-dev-02-container .faq__answer.rte p:last-child {
    margin-bottom: 0;
  }

  /* Mobile responsive */
  @media (max-width: 749px) {
    #shopify-section-{{ section.id }} .container.container--narrow.faq-dev-02-container {
      padding: 50px 16px;
      gap: 40px;
    }

    #shopify-section-{{ section.id }} .faq-dev-02-container .knowledge-center__title {
      font-size: 28px;
    }

    #shopify-section-{{ section.id }} .faq-dev-02-container .knowledge-center__subtitle {
      font-size: 14px;
    }

    #shopify-section-{{ section.id }} .faq-dev-02-container .faq__group {
      margin-bottom: 12px;
    }

    #shopify-section-{{ section.id }} .faq-dev-02-container .faq__group-title.heading.h2 {
      padding: 18px 16px;
      padding-right: 48px;
      font-size: 14px;
      border-radius: 10px;
    }

    #shopify-section-{{ section.id }} .faq-dev-02-container .faq__group-arrow-icon {
      right: 16px;
      width: 18px;
      height: 18px;
    }

    #shopify-section-{{ section.id }} .faq-dev-02-container button.faq__question.heading.h4 {
      padding: 16px 10px;
      font-size: 12px;
    }

    #shopify-section-{{ section.id }} .faq-dev-02-container .faq__arrow-icon {
      width: 16px;
      height: 16px;
      min-width: 16px;
    }

    #shopify-section-{{ section.id }} .faq-dev-02-container .faq__answer-wrapper.active {
      padding: 0 10px 16px 10px;
      max-height: 2000px; /* Even larger for mobile to ensure content shows */
    }
    
    #shopify-section-{{ section.id }} .faq-dev-02-container .faq__answer.rte {
      font-size: 12px;
    }
  }
  
</style>

<script>
// FAQ Functionality - SIMPLE AND GUARANTEED TO WORK
(function() {
  'use strict';
  
  // Function to initialize FAQ
  function initFAQ() {
    // Get the FAQ container
    const faqContainer = document.querySelector('.faq-dev-02-container');
    if (!faqContainer) return;
    
    console.log('Initializing FAQ functionality...');
    
    // Group toggle functionality
    const groupTriggers = faqContainer.querySelectorAll('.faq-group-trigger');
    console.log('Found', groupTriggers.length, 'group triggers');
    
    groupTriggers.forEach(trigger => {
      // Add click event - SIMPLIFIED, no cloning
      trigger.addEventListener('click', function(e) {
        e.preventDefault();
        e.stopPropagation();
        console.log('Group trigger clicked');
        
        const targetId = this.getAttribute('data-target');
        const targetElement = document.getElementById(targetId);
        const isExpanded = this.getAttribute('aria-expanded') === 'true';
        
        // Toggle aria-expanded
        this.setAttribute('aria-expanded', !isExpanded);
        
        // Toggle group content
        if (targetElement) {
          if (isExpanded) {
            // Close the group
            targetElement.classList.remove('active');
            
            // Also close all questions in this group
            const questionTriggers = targetElement.querySelectorAll('.faq-question-trigger');
            questionTriggers.forEach(qTrigger => {
              qTrigger.setAttribute('aria-expanded', 'false');
              const qTargetId = qTrigger.getAttribute('data-target');
              const qTargetElement = document.getElementById(qTargetId);
              if (qTargetElement) {
                qTargetElement.classList.remove('active');
              }
            });
          } else {
            // Open the group
            targetElement.classList.add('active');
          }
        }
      }, {once: false}); // Allow multiple event listeners
    });
    
    // Question toggle functionality
    const questionTriggers = faqContainer.querySelectorAll('.faq-question-trigger');
    console.log('Found', questionTriggers.length, 'question triggers');
    
    questionTriggers.forEach(trigger => {
      // Add click event - SIMPLIFIED, no cloning
      trigger.addEventListener('click', function(e) {
        e.preventDefault();
        e.stopPropagation();
        console.log('Question trigger clicked');
        
        const targetId = this.getAttribute('data-target');
        const targetElement = document.getElementById(targetId);
        const isExpanded = this.getAttribute('aria-expanded') === 'true';
        
        // Toggle aria-expanded
        this.setAttribute('aria-expanded', !isExpanded);
        
        // Toggle answer content
        if (targetElement) {
          if (isExpanded) {
            targetElement.classList.remove('active');
          } else {
            targetElement.classList.add('active');
          }
        }
      }, {once: false}); // Allow multiple event listeners
    });
  }
  
  // Initialize when DOM is ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initFAQ);
  } else {
    initFAQ();
  }
  
  // Re-initialize for Shopify section reloads
  if (typeof Shopify !== 'undefined') {
    document.addEventListener('shopify:section:load', function(event) {
      if (event.target.querySelector('.faq-dev-02-container') || 
          event.target.classList.contains('faq-dev-02-container')) {
        console.log('FAQ section reloaded, re-initializing...');
        setTimeout(initFAQ, 100);
      }
    });
  }
})();
</script>

{% schema %}
{
  "name": "FAQ",
  "settings": [
    {
      "type": "text",
      "id": "label",
      "label": "Section Label",
      "default": "KNOWLEDGE CENTER"
    },
    {
      "type": "text",
      "id": "title",
      "label": "Title",
      "default": "Knowledge Center"
    },
    {
      "type": "text",
      "id": "subtitle",
      "label": "Subtitle",
      "default": "Everything you need to know about Pro Spectrum"
    }
  ],
  "blocks": [
    {
      "type": "separator",
      "name": "Section separator",
      "settings": [
        {
          "type": "text",
          "id": "title",
          "label": "Heading",
          "default": "Default"
        },
        {
          "type": "image_picker",
          "id": "icon_image",
          "label": "Icon image",
          "info": "Upload your custom icon"
        },
        {
          "type": "color",
          "id": "icon_color",
          "label": "Icon color",
          "default": "#FFD700"
        },
        {
          "type": "range",
          "id": "icon_width",
          "label": "Icon width",
          "min": 10,
          "max": 100,
          "step": 2,
          "unit": "px",
          "default": 24
        },
        {
          "type": "range",
          "id": "icon_height",
          "label": "Icon height",
          "min": 10,
          "max": 100,
          "step": 2,
          "unit": "px",
          "default": 24
        },
        {
          "type": "range",
          "id": "icon_margin_top",
          "label": "Icon top margin",
          "min": 0,
          "max": 50,
          "step": 1,
          "unit": "px",
          "default": 0
        },
        {
          "type": "range",
          "id": "icon_margin_right",
          "label": "Icon right margin",
          "min": 0,
          "max": 50,
          "step": 1,
          "unit": "px",
          "default": 10
        },
        {
          "type": "range",
          "id": "icon_margin_bottom",
          "label": "Icon bottom margin",
          "min": 0,
          "max": 50,
          "step": 1,
          "unit": "px",
          "default": 0
        },
        {
          "type": "range",
          "id": "icon_margin_left",
          "label": "Icon left margin",
          "min": 0,
          "max": 50,
          "step": 1,
          "unit": "px",
          "default": 0
        }
      ]
    },
    {
      "type": "question",
      "name": "Question",
      "settings": [
        {
          "type": "text",
          "id": "title",
          "label": "Question"
        },
        {
          "type": "richtext",
          "id": "answer",
          "label": "Answer"
        }
      ]
    }
  ],
  "presets": [
    {
      "category": "Text",
      "name": "Frequently Asked Questions",
      "settings": {},
      "blocks": [
        {
          "type": "separator",
          "settings": {
            "title": "Shipping",
            "icon_width": 24,
            "icon_height": 24
          }
        },
        {
          "type": "question",
          "settings": {
            "title": "Do you ship overseas?",
            "answer": "<p>Yes, we ship all over the world. Shipping costs will apply, and will be added at checkout. We run discounts and promotions all year, so stay tuned for exclusive deals.</p>"
          }
        },
        {
          "type": "question",
          "settings": {
            "title": "How long does shipping take?",
            "answer": "<p>Shipping typically takes 5-7 business days domestically and 10-14 business days internationally.</p>"
          }
        },
        {
          "type": "separator",
          "settings": {
            "title": "Product"
          }
        },
        {
          "type": "question",
          "settings": {
            "title": "Can I return my product?",
            "answer": "<p>We always aim for make sure our customers love our products, but if you do need to return an order, we're happy to help. Just email us directly and we'll take you through the process.</p>"
          }
        },
        {
          "type": "question",
          "settings": {
            "title": "What is your warranty policy?",
            "answer": "<p>All products come with a 1-year manufacturer's warranty covering defects in materials and workmanship.</p>"
          }
        }
      ]
    }
  ]
}
{% endschema %}