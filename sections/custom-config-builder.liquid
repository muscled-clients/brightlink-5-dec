{{ 'custom-config-builder.css' | asset_url | stylesheet_tag }}

{% comment %} Get LED template data from product metafield {% endcomment %}
{% assign led_data = product.metafields.custom.led_template_data.value %}
{% assign config_builder_data = led_data.config_builder %}

<section class="custom-config" id="custom-config">
  <div class="custom-config__container">
    <!-- Header - Use metafield data if available, otherwise use section settings -->
    {% assign builder_title = config_builder_data.title | default: section.settings.title | default: 'Custom Configuration Builder' %}
    {% assign builder_description = config_builder_data.description | default: section.settings.subtitle | default: 'Configure your perfect LED display setup' %}

    <div class="custom-config__content">
      <div class="custom-config__header">
        <div class="custom-config__header-text">
          <h2 class="custom-config__title">{{ builder_title }}</h2>
          <p class="custom-config__subtitle">{{ builder_description }}</p>
        </div>
      </div>

      <div class="custom-config__card">
      <!-- Cabinet Inputs -->
      <div class="custom-config__input-row">
        <div class="custom-config__input-group">
          <label class="custom-config__input-label">CABINETS WIDE</label>
          <input type="number" class="custom-config__input" id="cabinets-wide" value="8" min="1" max="100">
        </div>
        <div class="custom-config__input-group">
          <label class="custom-config__input-label">CABINETS HIGH</label>
          <input type="number" class="custom-config__input" id="cabinets-high" value="8" min="1" max="100">
        </div>
      </div>

      <!-- Results -->
      <div class="custom-config__results-list">
        <div class="custom-config__result-row">
          <span class="custom-config__result-label">Total Resolution:</span>
          <span class="custom-config__result-value" id="result-resolution">8,294,400 pixels</span>
        </div>
        <div class="custom-config__result-row">
          <span class="custom-config__result-label">Physical Size:</span>
          <span class="custom-config__result-value" id="result-size">15.75' × 8.86'</span>
        </div>
        <div class="custom-config__result-row">
          <span class="custom-config__result-label">Diagonal:</span>
          <span class="custom-config__result-value" id="result-diagonal">217"</span>
        </div>
        <div class="custom-config__result-row">
          <span class="custom-config__result-label">Total Cabinets:</span>
          <span class="custom-config__result-value" id="result-cabinets">64 units</span>
        </div>
        <div class="custom-config__result-row">
          <span class="custom-config__result-label">Estimated Price:</span>
          <span class="custom-config__result-value" id="result-price">$149,000</span>
        </div>
      </div>

      <div class="custom-config__buttons">
        <a href="{{ section.settings.quote_button_link | default: '#' }}" class="custom-config__btn custom-config__btn--primary">
          <svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16" fill="none">
            <path d="M2 0C0.896875 0 0 0.896875 0 2V14C0 15.1031 0.896875 16 2 16H10C11.1031 16 12 15.1031 12 14V2C12 0.896875 11.1031 0 10 0H2ZM3 2H9C9.55313 2 10 2.44688 10 3V4C10 4.55312 9.55313 5 9 5H3C2.44688 5 2 4.55312 2 4V3C2 2.44688 2.44688 2 3 2ZM4 7C4 7.26522 3.89464 7.51957 3.70711 7.70711C3.51957 7.89464 3.26522 8 3 8C2.73478 8 2.48043 7.89464 2.29289 7.70711C2.10536 7.51957 2 7.26522 2 7C2 6.73478 2.10536 6.48043 2.29289 6.29289C2.48043 6.10536 2.73478 6 3 6C3.26522 6 3.51957 6.10536 3.70711 6.29289C3.89464 6.48043 4 6.73478 4 7ZM3 11C2.73478 11 2.48043 10.8946 2.29289 10.7071C2.10536 10.5196 2 10.2652 2 10C2 9.73478 2.10536 9.48043 2.29289 9.29289C2.48043 9.10536 2.73478 9 3 9C3.26522 9 3.51957 9.10536 3.70711 9.29289C3.89464 9.48043 4 9.73478 4 10C4 10.2652 3.89464 10.5196 3.70711 10.7071C3.51957 10.8946 3.26522 11 3 11ZM2 13C2 12.4469 2.44688 12 3 12H6C6.55312 12 7 12.4469 7 13C7 13.5531 6.55312 14 6 14H3C2.44688 14 2 13.5531 2 13ZM6 8C5.73478 8 5.48043 7.89464 5.29289 7.70711C5.10536 7.51957 5 7.26522 5 7C5 6.73478 5.10536 6.48043 5.29289 6.29289C5.48043 6.10536 5.73478 6 6 6C6.26522 6 6.51957 6.10536 6.70711 6.29289C6.89464 6.48043 7 6.73478 7 7C7 7.26522 6.89464 7.51957 6.70711 7.70711C6.51957 7.89464 6.26522 8 6 8ZM7 10C7 10.2652 6.89464 10.5196 6.70711 10.7071C6.51957 10.8946 6.26522 11 6 11C5.73478 11 5.48043 10.8946 5.29289 10.7071C5.10536 10.5196 5 10.2652 5 10C5 9.73478 5.10536 9.48043 5.29289 9.29289C5.48043 9.10536 5.73478 9 6 9C6.26522 9 6.51957 9.10536 6.70711 9.29289C6.89464 9.48043 7 9.73478 7 10ZM9 8C8.73478 8 8.48043 7.89464 8.29289 7.70711C8.10536 7.51957 8 7.26522 8 7C8 6.73478 8.10536 6.48043 8.29289 6.29289C8.48043 6.10536 8.73478 6 9 6C9.26522 6 9.51957 6.10536 9.70711 6.29289C9.89464 6.48043 10 6.73478 10 7C10 7.26522 9.89464 7.51957 9.70711 7.70711C9.51957 7.89464 9.26522 8 9 8ZM10 10C10 10.2652 9.89464 10.5196 9.70711 10.7071C9.51957 10.8946 9.26522 11 9 11C8.73478 11 8.48043 10.8946 8.29289 10.7071C8.10536 10.5196 8 10.2652 8 10C8 9.73478 8.10536 9.48043 8.29289 9.29289C8.48043 9.10536 8.73478 9 9 9C9.26522 9 9.51957 9.10536 9.70711 9.29289C9.89464 9.48043 10 9.73478 10 10Z" fill="#0A84FF"/>
          </svg>
          {{ section.settings.quote_button_text | default: 'GET CUSTOM QUOTE' }}
        </a>
        <a href="{{ section.settings.specs_button_link | default: '#' }}" class="custom-config__btn custom-config__btn--secondary">
          <svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16" fill="none">
            <path d="M2 0C0.896875 0 0 0.896875 0 2V14C0 15.1031 0.896875 16 2 16H10C11.1031 16 12 15.1031 12 14V2C12 0.896875 11.1031 0 10 0H2ZM3 2H9C9.55313 2 10 2.44688 10 3V4C10 4.55312 9.55313 5 9 5H3C2.44688 5 2 4.55312 2 4V3C2 2.44688 2.44688 2 3 2ZM4 7C4 7.26522 3.89464 7.51957 3.70711 7.70711C3.51957 7.89464 3.26522 8 3 8C2.73478 8 2.48043 7.89464 2.29289 7.70711C2.10536 7.51957 2 7.26522 2 7C2 6.73478 2.10536 6.48043 2.29289 6.29289C2.48043 6.10536 2.73478 6 3 6C3.26522 6 3.51957 6.10536 3.70711 6.29289C3.89464 6.48043 4 6.73478 4 7ZM3 11C2.73478 11 2.48043 10.8946 2.29289 10.7071C2.10536 10.5196 2 10.2652 2 10C2 9.73478 2.10536 9.48043 2.29289 9.29289C2.48043 9.10536 2.73478 9 3 9C3.26522 9 3.51957 9.10536 3.70711 9.29289C3.89464 9.48043 4 9.73478 4 10C4 10.2652 3.89464 10.5196 3.70711 10.7071C3.51957 10.8946 3.26522 11 3 11ZM2 13C2 12.4469 2.44688 12 3 12H6C6.55312 12 7 12.4469 7 13C7 13.5531 6.55312 14 6 14H3C2.44688 14 2 13.5531 2 13ZM6 8C5.73478 8 5.48043 7.89464 5.29289 7.70711C5.10536 7.51957 5 7.26522 5 7C5 6.73478 5.10536 6.48043 5.29289 6.29289C5.48043 6.10536 5.73478 6 6 6C6.26522 6 6.51957 6.10536 6.70711 6.29289C6.89464 6.48043 7 6.73478 7 7C7 7.26522 6.89464 7.51957 6.70711 7.70711C6.51957 7.89464 6.26522 8 6 8ZM7 10C7 10.2652 6.89464 10.5196 6.70711 10.7071C6.51957 10.8946 6.26522 11 6 11C5.73478 11 5.48043 10.8946 5.29289 10.7071C5.10536 10.5196 5 10.2652 5 10C5 9.73478 5.10536 9.48043 5.29289 9.29289C5.48043 9.10536 5.73478 9 6 9C6.26522 9 6.51957 9.10536 6.70711 9.29289C6.89464 9.48043 7 9.73478 7 10ZM9 8C8.73478 8 8.48043 7.89464 8.29289 7.70711C8.10536 7.51957 8 7.26522 8 7C8 6.73478 8.10536 6.48043 8.29289 6.29289C8.48043 6.10536 8.73478 6 9 6C9.26522 6 9.51957 6.10536 9.70711 6.29289C9.89464 6.48043 10 6.73478 10 7C10 7.26522 9.89464 7.51957 9.70711 7.70711C9.51957 7.89464 9.26522 8 9 8ZM10 10C10 10.2652 9.89464 10.5196 9.70711 10.7071C9.51957 10.8946 9.26522 11 9 11C8.73478 11 8.48043 10.8946 8.29289 10.7071C8.10536 10.5196 8 10.2652 8 10C8 9.73478 8.10536 9.48043 8.29289 9.29289C8.48043 9.10536 8.73478 9 9 9C9.26522 9 9.51957 9.10536 9.70711 9.29289C9.89464 9.48043 10 9.73478 10 10Z" fill="#FFF"/>
          </svg>
          {{ section.settings.specs_button_text | default: 'GET LED SPECIFICATIONS' }}
        </a>
      </div>
    </div>

    </div>

    <div class="custom-config__payment">
      <div class="custom-config__payment-header">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <rect width="20" height="14" x="2" y="5" rx="2"></rect>
          <line x1="2" y1="10" x2="22" y2="10"></line>
        </svg>
        <span>{{ section.settings.payment_title | default: 'Flexible Payment Options Available' }}</span>
      </div>
      <p class="custom-config__payment-info">{{ section.settings.payment_info | default: 'NET30 terms for qualified businesses | Leasing options from $2,100/month | Purchase orders accepted' }}</p>
      <a href="{{ section.settings.payment_link | default: '#' }}" class="custom-config__payment-link">{{ section.settings.payment_link_text | default: 'DISCUSS PAYMENT OPTIONS' }}</a>
    </div>
  </div>
</section>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Cabinet specifications (can be customized per product via metafields)
  const CABINET_SPECS = {
    width: 500,        // Cabinet width in mm
    height: 500,       // Cabinet height in mm
    pixelsWide: 360,   // Pixels per cabinet width
    pixelsHigh: 360,   // Pixels per cabinet height
    pricePerCabinet: 2328  // Price per cabinet in USD
  };

  // DOM Elements
  const cabinetsWideInput = document.getElementById('cabinets-wide');
  const cabinetsHighInput = document.getElementById('cabinets-high');

  const resultResolution = document.getElementById('result-resolution');
  const resultSize = document.getElementById('result-size');
  const resultDiagonal = document.getElementById('result-diagonal');
  const resultCabinets = document.getElementById('result-cabinets');
  const resultPrice = document.getElementById('result-price');

  // Calculate and update all results
  function calculateResults() {
    const cabinetsWide = parseInt(cabinetsWideInput.value) || 1;
    const cabinetsHigh = parseInt(cabinetsHighInput.value) || 1;

    // Total cabinets
    const totalCabinets = cabinetsWide * cabinetsHigh;

    // Total resolution (pixels)
    const totalPixelsWide = cabinetsWide * CABINET_SPECS.pixelsWide;
    const totalPixelsHigh = cabinetsHigh * CABINET_SPECS.pixelsHigh;
    const totalResolution = totalPixelsWide * totalPixelsHigh;

    // Physical size in feet (convert from mm)
    const widthMm = cabinetsWide * CABINET_SPECS.width;
    const heightMm = cabinetsHigh * CABINET_SPECS.height;
    const widthFeet = (widthMm / 304.8).toFixed(2);
    const heightFeet = (heightMm / 304.8).toFixed(2);

    // Diagonal in inches
    const widthInches = widthMm / 25.4;
    const heightInches = heightMm / 25.4;
    const diagonalInches = Math.sqrt(widthInches * widthInches + heightInches * heightInches);

    // Estimated price
    const estimatedPrice = totalCabinets * CABINET_SPECS.pricePerCabinet;

    // Update display
    resultResolution.textContent = totalResolution.toLocaleString() + ' pixels';
    resultSize.textContent = widthFeet + "' × " + heightFeet + "'";
    resultDiagonal.textContent = Math.round(diagonalInches) + '"';
    resultCabinets.textContent = totalCabinets + ' units';
    resultPrice.textContent = '$' + estimatedPrice.toLocaleString();
  }

  // Event listeners
  if (cabinetsWideInput && cabinetsHighInput) {
    cabinetsWideInput.addEventListener('input', calculateResults);
    cabinetsHighInput.addEventListener('input', calculateResults);
  }

  // Initial calculation
  calculateResults();
});
</script>

{% schema %}
{
  "name": "Custom Config Builder",
  "tag": "section",
  "class": "custom-config-section",
  "settings": [
    {
      "type": "header",
      "content": "Header Section"
    },
    {
      "type": "text",
      "id": "label",
      "label": "Section Label",
      "default": "CONFIGURATION TOOL"
    },
    {
      "type": "text",
      "id": "title",
      "label": "Title",
      "default": "Custom Configuration Builder"
    },
    {
      "type": "text",
      "id": "subtitle",
      "label": "Subtitle",
      "default": "Need a different size? Configure a custom array"
    },
    {
      "type": "header",
      "content": "Buttons"
    },
    {
      "type": "text",
      "id": "quote_button_text",
      "label": "Quote Button Text",
      "default": "GET CUSTOM QUOTE"
    },
    {
      "type": "url",
      "id": "quote_button_link",
      "label": "Quote Button Link"
    },
    {
      "type": "text",
      "id": "specs_button_text",
      "label": "Specs Button Text",
      "default": "GET LED SPECIFICATIONS"
    },
    {
      "type": "url",
      "id": "specs_button_link",
      "label": "Specs Button Link"
    },
    {
      "type": "header",
      "content": "Payment Section"
    },
    {
      "type": "text",
      "id": "payment_title",
      "label": "Payment Title",
      "default": "Flexible Payment Options Available"
    },
    {
      "type": "text",
      "id": "payment_info",
      "label": "Payment Info",
      "default": "NET30 terms for qualified businesses | Leasing options from $2,100/month | Purchase orders accepted"
    },
    {
      "type": "text",
      "id": "payment_link_text",
      "label": "Payment Link Text",
      "default": "DISCUSS PAYMENT OPTIONS"
    },
    {
      "type": "url",
      "id": "payment_link",
      "label": "Payment Link"
    }
  ],
  "presets": [
    {
      "name": "Custom Config Builder"
    }
  ]
}
{% endschema %}
